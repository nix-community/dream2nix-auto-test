
Translating:: data-memocombinators (translator: hackage) (lock path: /home/runner/work/dream2nix-auto-test/dream2nix-auto-test/pkgs-haskell/locks/data-memocombinators-0.5.1/dream-lock.json)
+ '[' -e /home/runner/.cabal/packages/hackage.haskell.org/01-index.cache ']'
++ stat -c %Y /home/runner/.cabal/packages/hackage.haskell.org/01-index.cache
+ indexTime=1678515378
++ date +%s
+ age=872
+ '[' 872 -gt 86400 ']'
/tmp/tmp.bo51Z7m7SF/tmp.eAsgpYLlXh/tmp.FK5UcFLiYP ~/work/dream2nix-auto-test/dream2nix-auto-test/pkgs-haskell/locks
downloading https://hackage.haskell.org/package/data-memocombinators-0.5.1/data-memocombinators-0.5.1.tar.gz
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100  3066    0  3066    0     0  11648      0 --:--:-- --:--:-- --:--:-- 11657
Resolving dependencies...
Wrote freeze file:
/tmp/tmp.bo51Z7m7SF/tmp.eAsgpYLlXh/tmp.FK5UcFLiYP/source/cabal.project.freeze
/tmp/tmp.bo51Z7m7SF/tmp.eAsgpYLlXh/tmp.FK5UcFLiYP
~/work/dream2nix-auto-test/dream2nix-auto-test/pkgs-haskell/locks
/tmp/tmp.bo51Z7m7SF/tmp.eAsgpYLlXh/tmp.FK5UcFLiYP/tmp.mgdKwX057n ~/work/dream2nix-auto-test/dream2nix-auto-test/pkgs-haskell/locks
error: unable to download 'https://github.com/davhau/cabal2json/tarball/plan-json': HTTP error 404

       response body:

       Not Found

       … while evaluating the attribute 'value'

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/types.nix:495:38:

          494|               elemType
          495|               [{ inherit (def) file; value = def'; }]
             |                                      ^
          496|             ).optionalValue

       … while evaluating 'dischargeProperties'

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/modules.nix:799:25:

          798|   */
          799|   dischargeProperties = def:
             |                         ^
          800|     if def._type or "" == "merge" then

       … from call site

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/modules.nix:728:137:

          727|         defs' = concatMap (m:
          728|           map (value: { inherit (m) file; inherit value; }) (builtins.addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))
             |                                                                                                                                         ^
          729|         ) defs;

       … while evaluating definitions from `/nix/store/q38wvs606kplqq79i1q4ivjkj5dwb8q3-src/modules/translators/implementation.nix':

       … while evaluating anonymous lambda

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/modules.nix:727:28:

          726|         # Process mkMerge and mkIf properties.
          727|         defs' = concatMap (m:
             |                            ^
          728|           map (value: { inherit (m) file; inherit value; }) (builtins.addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))

       … from call site

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/modules.nix:727:17:

          726|         # Process mkMerge and mkIf properties.
          727|         defs' = concatMap (m:
             |                 ^
          728|           map (value: { inherit (m) file; inherit value; }) (builtins.addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))

       … while evaluating the attribute 'values'

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/modules.nix:840:7:

          839|     in {
          840|       values = concatMap (def: if getPrio def == highestPrio then [(strip def)] else []) defs;
             |       ^
          841|       inherit highestPrio;

       … while evaluating the attribute 'values'

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/modules.nix:741:9:

          740|       in {
          741|         values = defs''';
             |         ^
          742|         inherit (defs'') highestPrio;

       … while evaluating the attribute 'optionalValue'

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/modules.nix:759:5:

          758|
          759|     optionalValue =
             |     ^
          760|       if isDefined then { value = mergedValue; }

       … while evaluating anonymous lambda

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/types.nix:491:21:

          490|         map (x: x.value) (filter (x: x ? value) (concatLists (imap1 (n: def:
          491|           imap1 (m: def':
             |                     ^
          492|             (mergeDefinitions

       … from call site

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/lists.nix:117:32:

          116|   */
          117|   imap1 = f: list: genList (n: f (n + 1) (elemAt list n)) (length list);
             |                                ^
          118|

       … while evaluating anonymous lambda

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/lists.nix:117:29:

          116|   */
          117|   imap1 = f: list: genList (n: f (n + 1) (elemAt list n)) (length list);
             |                             ^
          118|

       … from call site

       … while evaluating anonymous lambda

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/types.nix:490:35:

          489|       merge = loc: defs:
          490|         map (x: x.value) (filter (x: x ? value) (concatLists (imap1 (n: def:
             |                                   ^
          491|           imap1 (m: def':

       … from call site

       … while evaluating 'merge'

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/types.nix:489:20:

          488|       check = isList;
          489|       merge = loc: defs:
             |                    ^
          490|         map (x: x.value) (filter (x: x ? value) (concatLists (imap1 (n: def:

       … from call site

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/modules.nix:749:59:

          748|       if isDefined then
          749|         if all (def: type.check def.value) defsFinal then type.merge loc defsFinal
             |                                                           ^
          750|         else let allInvalid = filter (def: ! type.check def.value) defsFinal;

       … while evaluating the attribute 'mergedValue'

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/modules.nix:747:5:

          746|     # Type-check the remaining definitions, and merge them. Or throw if no definitions.
          747|     mergedValue =
             |     ^
          748|       if isDefined then

       … while evaluating the option `translators.cabal-plan.generateUnitTestsForProjects':

       … while evaluating the attribute 'value'

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/modules.nix:712:9:

          711|     in warnDeprecation opt //
          712|       { value = builtins.addErrorContext "while evaluating the option `${showOption loc}':" value;
             |         ^
          713|         inherit (res.defsFinal') highestPrio;

       … while evaluating anonymous lambda

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/modules.nix:265:72:

          264|           # For definitions that have an associated option
          265|           declaredConfig = mapAttrsRecursiveCond (v: ! isOption v) (_: v: v.value) options;
             |                                                                        ^
          266|

       … from call site

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/attrsets.nix:401:20:

          400|               then recurse (path ++ [name]) value
          401|               else f (path ++ [name]) value;
             |                    ^
          402|         in mapAttrs g;

       … while evaluating 'g'

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/attrsets.nix:398:19:

          397|           g =
          398|             name: value:
             |                   ^
          399|             if isAttrs value && cond value

       … from call site

       … while evaluating the attribute 'value'

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/types.nix:524:60:

          523|           # Push down position info.
          524|           (map (def: mapAttrs (n: v: { inherit (def) file; value = v; }) def.value) defs)));
             |                                                            ^
          525|       emptyValue = { value = {}; };

       … while evaluating 'dischargeProperties'

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/modules.nix:799:25:

          798|   */
          799|   dischargeProperties = def:
             |                         ^
          800|     if def._type or "" == "merge" then

       … from call site

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/modules.nix:728:137:

          727|         defs' = concatMap (m:
          728|           map (value: { inherit (m) file; inherit value; }) (builtins.addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))
             |                                                                                                                                         ^
          729|         ) defs;

       … while evaluating definitions from `/nix/store/q38wvs606kplqq79i1q4ivjkj5dwb8q3-src/modules/translators/implementation.nix':

       … while evaluating anonymous lambda

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/modules.nix:727:28:

          726|         # Process mkMerge and mkIf properties.
          727|         defs' = concatMap (m:
             |                            ^
          728|           map (value: { inherit (m) file; inherit value; }) (builtins.addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))

       … from call site

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/modules.nix:727:17:

          726|         # Process mkMerge and mkIf properties.
          727|         defs' = concatMap (m:
             |                 ^
          728|           map (value: { inherit (m) file; inherit value; }) (builtins.addErrorContext "while evaluating definitions from `${m.file}':" (dischargeProperties m.value))

       … while evaluating the attribute 'values'

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/modules.nix:840:7:

          839|     in {
          840|       values = concatMap (def: if getPrio def == highestPrio then [(strip def)] else []) defs;
             |       ^
          841|       inherit highestPrio;

       … while evaluating the attribute 'values'

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/modules.nix:741:9:

          740|       in {
          741|         values = defs''';
             |         ^
          742|         inherit (defs'') highestPrio;

       … while evaluating the attribute 'optionalValue'

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/modules.nix:759:5:

          758|
          759|     optionalValue =
             |     ^
          760|       if isDefined then { value = mergedValue; }

       … while evaluating anonymous lambda

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/types.nix:520:86:

          519|       merge = loc: defs:
          520|         mapAttrs (n: v: v.value) (filterAttrs (n: v: v ? value) (zipAttrsWith (name: defs:
             |                                                                                      ^
          521|             (mergeDefinitions (loc ++ [name]) elemType defs).optionalValue

       … from call site

       … while evaluating anonymous lambda

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/types.nix:520:51:

          519|       merge = loc: defs:
          520|         mapAttrs (n: v: v.value) (filterAttrs (n: v: v ? value) (zipAttrsWith (name: defs:
             |                                                   ^
          521|             (mergeDefinitions (loc ++ [name]) elemType defs).optionalValue

       … from call site

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/attrsets.nix:225:62:

          224|   filterAttrs = pred: set:
          225|     listToAttrs (concatMap (name: let v = set.${name}; in if pred name v then [(nameValuePair name v)] else []) (attrNames set));
             |                                                              ^
          226|

       … while evaluating anonymous lambda

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/attrsets.nix:225:29:

          224|   filterAttrs = pred: set:
          225|     listToAttrs (concatMap (name: let v = set.${name}; in if pred name v then [(nameValuePair name v)] else []) (attrNames set));
             |                             ^
          226|

       … from call site

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/attrsets.nix:225:18:

          224|   filterAttrs = pred: set:
          225|     listToAttrs (concatMap (name: let v = set.${name}; in if pred name v then [(nameValuePair name v)] else []) (attrNames set));
             |                  ^
          226|

       … while evaluating 'filterAttrs'

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/attrsets.nix:224:23:

          223|   */
          224|   filterAttrs = pred: set:
             |                       ^
          225|     listToAttrs (concatMap (name: let v = set.${name}; in if pred name v then [(nameValuePair name v)] else []) (attrNames set));

       … from call site

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/types.nix:520:35:

          519|       merge = loc: defs:
          520|         mapAttrs (n: v: v.value) (filterAttrs (n: v: v ? value) (zipAttrsWith (name: defs:
             |                                   ^
          521|             (mergeDefinitions (loc ++ [name]) elemType defs).optionalValue

       … while evaluating 'merge'

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/types.nix:519:20:

          518|       check = isAttrs;
          519|       merge = loc: defs:
             |                    ^
          520|         mapAttrs (n: v: v.value) (filterAttrs (n: v: v ? value) (zipAttrsWith (name: defs:

       … from call site

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/types.nix:261:12:

          260|           }.${commonType} or mergeEqualOption;
          261|         in mergeFunction loc defs;
             |            ^
          262|     };

       … while evaluating 'merge'

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/types.nix:227:20:

          226|       check = value: true;
          227|       merge = loc: defs:
             |                    ^
          228|         let

       … from call site

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/modules.nix:749:59:

          748|       if isDefined then
          749|         if all (def: type.check def.value) defsFinal then type.merge loc defsFinal
             |                                                           ^
          750|         else let allInvalid = filter (def: ! type.check def.value) defsFinal;

       … while evaluating the attribute 'value'

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/modules.nix:760:27:

          759|     optionalValue =
          760|       if isDefined then { value = mergedValue; }
             |                           ^
          761|       else {};

       … while evaluating anonymous lambda

       at /nix/store/lylk592ybx0xcgq38pji45mrm1188h7w-c0r6da6r9kq748dhyqjp5gq39sng9z1j-4lbmf3pbrsb0a5l4713mal64w8hp6na9-source/lib/types.nix:520:22:

          519|       merge = loc: defs:
          520|         mapAttrs (n: v: v.value) (filterAttrs (n: v: v ? value) (zipAttrsWith (name: defs:
             |                      ^
          521|             (mergeDefinitions (loc ++ [name]) elemType defs).optionalValue

       … from call site

       … while evaluating 'toJSON'

       at /nix/store/q38wvs606kplqq79i1q4ivjkj5dwb8q3-src/modules/utils.dream-lock/implementation.nix:329:12:

          328|
          329|   toJSON = dreamLock: let
             |            ^
          330|     lock =

       … from call site

       at «string»:19:5:

           18|   in
           19|     dream2nix.utils.dream-lock.toJSON
             |     ^
           20|       # don't use nix to detect cycles, this will be more efficient in python
Traceback (most recent call last):
  File "/nix/store/nik4n0q1rv0828pjrpic1m07mg225576-format-dream-lock.py", line 16, in <module>
    lock = json.loads(sys.stdin.read())
  File "/nix/store/9srs642k875z3qdk8glapjycncf2pa51-python3-3.10.7/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/nix/store/9srs642k875z3qdk8glapjycncf2pa51-python3-3.10.7/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/nix/store/9srs642k875z3qdk8glapjycncf2pa51-python3-3.10.7/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
